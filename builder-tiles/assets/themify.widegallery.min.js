(function(d,c,a,f){var e={info:".twg-info",terms:".twg-terms",title:".twg-title",date:".twg-date",primaryAction:".twg-primary-action",actions:".twg-actions",speed:300,event:"click",ajax_url:"",ajax_action:"themify_get_gallery_entry",ajax_nonce:"",networkError:"",termSeparator:"",loader:'<div class="themify-loader"><div class="themify-loader_1 themify-loader_blockG"></div><div class="themify-loader_2 themify-loader_blockG"></div><div class="themify-loader_3 themify-loader_blockG"></div></div>'};function b(h,g){this.element=h;this.options=d.extend({},e,g);this._defaults=e;this.init()}b.prototype={init:function(){if(d(this.element).hasClass("twg-gallery-shortcode")){this.galleryShortcode()}else{this.galleryPostType()}var g,h=this;d(c).resize(function(){clearTimeout(g);g=setTimeout(function(){h.doneResizing(d(h.element))},500)}).on("orientationchange",function(){h.doneResizing(d(h.element))})},galleryPostType:function(){var i=this,h=d(this.element),g=d(".twg-controls",this.element),l=d(".twg-holder",this.element),k=d(".twg-loading",this.element),j=d("<img />");j.on("load",function(){var m=d(".twg-link:first-child",g);k.html("").fadeOut();if(typeof d.fn.backstretch!=="undefined"){h.backstretch(d(this).attr("src"));d(".backstretch",h).addClass("twg-deleteable").hide().fadeIn()}else{d(this).addClass("twg-deleteable").hide().prependTo(h).fadeIn()}i.displayEntry(m.data("entry_id"))}).attr("src",d(".twg-link:first-child",g).data("image"));g.on(i.options.event,".twg-link",function(m){m.preventDefault();i.initEntryDisplay(d(this))})},initEntryDisplay:function(k){var h=this,g=d(this.element),l=d(".twg-loading",this.element),i=k.data("image"),j=d("<img />");l.html(h.options.loader).fadeIn();j.on("load",function(){if(typeof d.fn.backstretch!=="undefined"){g.backstretch(d(this).attr("src"));d(".backstretch",g).addClass("twg-behind")}else{d(this).addClass("twg-behind").prependTo(g)}d(".twg-deleteable",g).fadeOut(h.options.speed,function(){d(".twg-behind",g).addClass("twg-deleteable").removeClass("twg-behind");d(this).remove();l.html("").fadeOut()});h.displayEntry(k.data("entry_id"))}).attr("src",i)},displayEntry:function(h){var o=this,g=d(this.options.info,o.element),j=d(this.options.terms,o.element),m=d(this.options.title,o.element),i=d(this.options.date,o.element),l=d(this.options.primaryAction,o.element),n=d(this.options.actions,o.element),k=d(".twg-caption",this.element);g.fadeOut(o.options.speed);d.post(o.options.ajax_url,{action:o.options.ajax_action,nonce:o.options.ajax_nonce,entry_id:h},function(q,p){if("success"!=p){k.text(o.options.networkError).wrapInner('<div class="text-caption" />');return}var r=jQuery.parseJSON(q);j.empty();d.each(r.terms,function(s,t){d('<a href="'+t.link+'">'+t.name+"</a>").appendTo(j);d('<span class="separator">'+o.options.termSeparator+"</span>").appendTo(j)});m.text(r.title).attr("href",r.link);i.text(r.date);k.empty();k.append(r.excerpt);if(r.excerpt!=""){k.wrapInner('<div class="text-caption" />')}l.attr("href",r.link);n.fadeIn();g.fadeIn(o.options.speed)})},galleryShortcode:function(){var i=this,h=d(this.element),k=d(".twg-caption",this.element),g=d(".twg-controls",this.element),j=d(".twg-loading",this.element);$img=d("<img />");$img.on("load",function(){j.html("").fadeOut();if(typeof d.fn.backstretch!=="undefined"){h.backstretch(d(this).attr("src"));d(".backstretch",h).addClass("twg-deleteable").hide().fadeIn(i.options.speed,function(){k.text(d(".twg-link:first-child",g).data("description"));if(k.text()!=""){k.wrapInner('<div class="text-caption" />')}})}else{d(this).addClass("twg-deleteable").hide().prependTo(h).fadeIn(i.options.speed,function(){k.text(d(".twg-link:first-child",g).data("description"));if(k.text()!=""){k.wrapInner('<div class="text-caption" />')}})}}).attr("src",d(".twg-link:first-child",g).data("image"));g.on(i.options.event,".twg-link",function(l){l.preventDefault();i.initImageDisplay(d(this))})},initImageDisplay:function(k){var h=this,g=d(this.element),m=d(".twg-caption",this.element),l=d(".twg-loading",this.element),i=k.data("image"),j=d("<img />");l.html(h.options.loader).fadeIn();j.on("load",function(){if(typeof d.fn.backstretch!=="undefined"){g.backstretch(d(this).attr("src"));d(".backstretch",g).addClass("twg-behind")}else{d(this).addClass("twg-behind").prependTo(g)}d(".twg-deleteable",g).fadeOut(h.options.speed,function(){d(".twg-behind",g).addClass("twg-deleteable").removeClass("twg-behind");d(this).remove();l.html("").fadeOut()});m.fadeOut(h.options.speed,function(){d(this).text(k.data("description")).fadeIn();if(d(this).text()!=""){m.wrapInner('<div class="text-caption" />')}})}).attr("src",i)},doneResizing:function(h){if(typeof d.fn.backstretch!=="undefined"){var g=h.data("backstretch");if("undefined"!==typeof g){g.resize()}}},isTouchDevice:function(){try{a.createEvent("TouchEvent");return true}catch(g){return false}}};d.fn.ThemifyWideGallery=function(g){return this.each(function(){var h=d.data(this,"ThemifyWideGallery");if(!h){d.data(this,"ThemifyWideGallery",new b(this,g))}if("undefined"!=typeof g.method&&"function"==typeof h[g.method]){if("undefined"!=typeof g.element){h[g.method](g.element)}else{h[g.method]()}}})}})(jQuery,window,document);